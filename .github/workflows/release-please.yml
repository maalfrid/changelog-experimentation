on:
  push:
    branches:
      - main
name: release-please
jobs:
  release-please:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      - name: Save package.json version to GITHUB_ENV
        run: |
          import os
          import json
          github_env = os.getenv('GITHUB_ENV')
          with open('./package.json') as file:
            package_json = json.load(file)
          with open(github_env, "a") as file:
            file.write("app_version=" + package_json['version'] + "")
          print("app_version" + package_json['version'] + "is saved to GITHUB_ENV")
        shell: python
      - uses: google-github-actions/release-please-action@v3
        with:
          release-type: node
          package-name: release-please-action
          release-as: "${{ env.app_version }}"